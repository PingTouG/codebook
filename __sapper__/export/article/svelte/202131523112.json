{"title":"一分钟了解Svelte","slug":"svelte","time":"2021-3-15 23:7:25","author":"PingTouG","html":"<p>如今主流的前端框架(<code>React</code>、<code>Vue</code>)都是在浏览器中完成大部分的工作（<code>runtime</code>），并且借助于<code>virtual DOM(虚拟DOM)</code>和<code>Diff算法</code>来实现局部更新。所以对于<code>React</code>或<code>Vue</code>来说不可避免的需要引入<code>runtime code</code>以及<code>virtual DOM</code>所带来的性能损耗。而 <code>Svelte</code>则是使用了一个全新的方式来构建用户界面。</p>\n<h2 id=\"svelte三大特点\">Svelte三大特点</h2>\n<ul>\n<li>Write less code(更少的编码)</li>\n<li>No virtual DOM(无虚拟DOM)</li>\n<li>Truly reactive(真正的响应式)</li>\n</ul>\n<h3 id=\"write-less-code\">Write less code</h3>\n<p>相对于<code>React</code>、<code>Vue</code>，<code>Svelte</code>在编写代码时可通过少量的代码来完成相同的事情。比如：<code>一个简单的计数器</code></p>\n<p><code>React</code></p>\n<pre><code class=\"language-react\"><span class=\"hljs-keyword\">import</span> React,{ useState } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;react&#x27;</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> () =&gt; {\n    <span class=\"hljs-keyword\">const</span> [count,setCount] = useState(<span class=\"hljs-number\">0</span>)\n    <span class=\"hljs-keyword\">const</span> onAdd = <span class=\"hljs-function\">() =&gt;</span> setCount(count+<span class=\"hljs-number\">1</span>)\n\n    <span class=\"hljs-keyword\">return</span> (\n        <span class=\"xml\"><span class=\"hljs-tag\">&lt;&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>{count}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{onAdd}</span>&gt;</span>+1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;/&gt;</span></span>\n    )\n}\n</code></pre>\n<p><code>Vue2</code></p>\n<pre><code class=\"language-vue\"><span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">template</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span></span><span class=\"hljs-template-variable\">{{<span class=\"hljs-name\">count</span>}}</span><span class=\"xml\"><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> @<span class=\"hljs-attr\">click</span>=<span class=\"hljs-string\">&quot;onAdd&quot;</span>&gt;</span>+1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">template</span>&gt;</span>\n\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"javascript\">\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n    <span class=\"hljs-function\"><span class=\"hljs-title\">data</span>(<span class=\"hljs-params\"></span>)</span>{\n        <span class=\"hljs-keyword\">return</span> {\n            <span class=\"hljs-attr\">count</span>: <span class=\"hljs-number\">0</span>\n        }\n    },\n    <span class=\"hljs-attr\">methods</span>: {\n        <span class=\"hljs-function\"><span class=\"hljs-title\">onAdd</span>(<span class=\"hljs-params\"></span>)</span>{\n            <span class=\"hljs-built_in\">this</span>.count++\n        }\n    }\n}\n</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></span>\n</code></pre>\n<p><code>Vue3</code></p>\n<pre><code class=\"language-vue\"><span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">template</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span></span><span class=\"hljs-template-variable\">{{<span class=\"hljs-name\">count</span>}}</span><span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> @<span class=\"hljs-attr\">click</span>=<span class=\"hljs-string\">&quot;onAdd&quot;</span>&gt;</span>+1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">template</span>&gt;</span>\n\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"javascript\">\n<span class=\"hljs-keyword\">import</span> { ref } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;vue&#x27;</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n    <span class=\"hljs-function\"><span class=\"hljs-title\">setup</span>(<span class=\"hljs-params\"></span>)</span>{\n        <span class=\"hljs-keyword\">const</span> count = ref(<span class=\"hljs-number\">0</span>)\n        <span class=\"hljs-keyword\">const</span> onAdd = <span class=\"hljs-function\">() =&gt;</span> count.value++\n\n        <span class=\"hljs-keyword\">return</span> {\n            count,\n            onAdd\n        }\n    }\n}\n</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></span>\n</code></pre>\n<p><code>Vue3 script setup rfc</code></p>\n<pre><code class=\"language-vue\"><span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">template</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span></span><span class=\"hljs-template-variable\">{{<span class=\"hljs-name\">count</span>}}</span><span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> @<span class=\"hljs-attr\">click</span>=<span class=\"hljs-string\">&quot;onAdd&quot;</span>&gt;</span>+1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">template</span>&gt;</span>\n\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">setup</span>&gt;</span><span class=\"javascript\">\n<span class=\"hljs-keyword\">import</span> { ref } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;vue&#x27;</span>\n\n<span class=\"hljs-keyword\">const</span> count = ref(<span class=\"hljs-number\">0</span>)\n<span class=\"hljs-keyword\">const</span> onAdd = <span class=\"hljs-function\">() =&gt;</span> count.value++\n</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></span>\n</code></pre>\n<p><code>Svelte</code></p>\n<pre><code class=\"language-svelte\"><span class=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"javascript\">\n    <span class=\"hljs-keyword\">let</span> count = <span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">const</span> onAdd = <span class=\"hljs-function\">() =&gt;</span> count++\n</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\n\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span></span><span class=\"hljs-template-variable\">{count}</span><span class=\"xml\"><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">on:click</span>=</span></span><span class=\"hljs-template-variable\">{onAdd}</span><span class=\"xml\"><span class=\"hljs-tag\">&gt;</span>+1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span></span>\n</code></pre>\n<p>上述分别列举了在<code>React</code>,<code>Vue2</code>,<code>Vue3</code>,<code>Vue3 script setup rfc</code>，<code>Svelte</code>中的实现一个简单的计数器，从中可以看出，仅当<code>Vue3</code>使用了<code>script setup</code>的提案后相对于其他实现足够精简了，但对比<code>Svelte</code>来说还不够精简，在<a href=\"https://svelte.dev/blog/write-less-code\">此文</a>中有官方列举的例子。</p>\n<h3 id=\"no-virtual-dom\">No virtual DOM</h3>\n<p><code>Svelte</code>没有<code>虚拟DOM</code>，也不存在<code>runtime code</code>，<code>Svelte</code>的魔法发生在构建时，即<code>Svelte</code>是一个编译器，在编译过程中注入所需的魔法代码。在<a href=\"https://svelte.dev/blog/virtual-dom-is-pure-overhead\">此文</a>中有详细内容来说明此特点。</p>\n<h3 id=\"truky-reactive\">Truky reactive</h3>\n<p><code>Svelte</code>中实现了真正的响应式，省去了响应式使用代理或访问器的开销和复杂性，仅仅一个变量便可实现拥有响应式。在上述<code>一个简单的计数器</code>的例子中可以看出，只是定义了一个变量<code>count</code>,然后<code>count++</code>变可以自动更新视图，可谓是惊喜。<a href=\"https://svelte.dev/blog/svelte-3-rethinking-reactivity\">此文</a>有一个简短的介绍。</p>\n"}